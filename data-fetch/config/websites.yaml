# Data-Fetch Website Configurations
# This file contains configurations for websites that have been set up for data extraction.

sites:
  # The Block - BTC and ETH Total Exchange Volume (7DMA)
  - id: theblock_btc_eth_volume_7dma
    name: "The Block - BTC/ETH Exchange Volume 7DMA"
    base_url: "https://www.theblock.co"
    page_url: "https://www.theblock.co/data/crypto-markets/spot/btc-and-eth-total-exchange-volume-7dma"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://www.theblock.co/api/charts/chart/crypto-markets/spot/btc-and-eth-total-exchange-volume-7dma"
      method: "GET"
      requires_auth: false
      headers: {}
    field_mappings:
      date: "Date"
      btc_volume_7dma: "BTC"
      eth_volume_7dma: "ETH"
    robots_policy:
      status: "UNKNOWN"
      last_checked: null
      override_approved: false
    metadata:
      created: "2024-01-15T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
    rate_limit: 2.0  # seconds between requests

  # CoinGecko - Exchange Volume (Public API)
  - id: coingecko_exchange_volume
    name: "CoinGecko - Exchange Volume"
    base_url: "https://api.coingecko.com"
    page_url: "https://api.coingecko.com/api/v3/exchanges"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://api.coingecko.com/api/v3/exchanges"
      method: "GET"
      requires_auth: false
      headers:
        Accept: "application/json"
    field_mappings:
      id: "id"
      name: "name"
      volume_24h: "trade_volume_24h_btc"
    robots_policy:
      status: "ALLOWED"
      last_checked: "2024-01-15T00:00:00Z"
      override_approved: false
    metadata:
      created: "2024-01-15T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
    rate_limit: 1.0

  # CoinGecko - BTC Market Chart (Historical Data)
  - id: coingecko_btc_market_chart
    name: "CoinGecko - BTC Market Chart"
    base_url: "https://api.coingecko.com"
    page_url: "https://api.coingecko.com/api/v3/coins/bitcoin/market_chart"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=30"
      method: "GET"
      requires_auth: false
      headers:
        Accept: "application/json"
    field_mappings:
      prices: "prices"
      market_caps: "market_caps"
      total_volumes: "total_volumes"
    robots_policy:
      status: "ALLOWED"
      last_checked: "2024-12-04T00:00:00Z"
      override_approved: false
    metadata:
      created: "2024-12-04T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
    rate_limit: 1.0

  # Legacy CryptoCompare - Daily Exchange Volume (deprecated, use CoinDesk)
  - id: cryptocompare_exchange_volume
    name: "CryptoCompare - Daily Exchange Volume (Legacy)"
    base_url: "https://min-api.cryptocompare.com"
    page_url: "https://min-api.cryptocompare.com/data/exchange/histoday"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://min-api.cryptocompare.com/data/exchange/histoday?tsym=USD&limit=30"
      method: "GET"
      requires_auth: false
      headers:
        Accept: "application/json"
    field_mappings:
      date: "time"
      volume: "volume"
    robots_policy:
      status: "ALLOWED"
      last_checked: "2024-01-15T00:00:00Z"
      override_approved: false
    metadata:
      created: "2024-01-15T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
    rate_limit: 0.5

  # Alpha Vantage - Company Overview
  - id: alphavantage_company_overview
    name: "Alpha Vantage - Company Overview"
    base_url: "https://www.alphavantage.co"
    page_url: "https://www.alphavantage.co/query?function=OVERVIEW&symbol=AAPL"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://www.alphavantage.co/query?function=OVERVIEW&symbol=AAPL"
      method: "GET"
      requires_auth: false
      headers:
        Accept: "application/json"
    field_mappings:
      Symbol: "Symbol"
      Name: "Name"
      MarketCapitalization: "MarketCapitalization"
      Sector: "Sector"
      Industry: "Industry"
    robots_policy:
      status: "ALLOWED"
      last_checked: "2024-12-05T00:00:00Z"
      override_approved: false
    metadata:
      created: "2024-12-05T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
    rate_limit: 12.0  # seconds between requests (5 calls/minute for free tier)

  # Alpha Vantage - Top 20 Stocks by Market Cap
  - id: alphavantage_top_20_stocks
    name: "Alpha Vantage - Top 20 Stocks by Market Cap"
    base_url: "https://www.alphavantage.co"
    page_url: "https://www.alphavantage.co/query?function=OVERVIEW&symbol=AAPL"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://www.alphavantage.co/query?function=OVERVIEW"
      method: "GET"
      requires_auth: false
      headers:
        Accept: "application/json"
    field_mappings:
      Symbol: "Symbol"
      Name: "Name"
      MarketCapitalization: "MarketCapitalization"
      Sector: "Sector"
      Industry: "Industry"
      Price: "52WeekHigh"
    robots_policy:
      status: "ALLOWED"
      last_checked: "2024-12-05T00:00:00Z"
      override_approved: false
    metadata:
      created: "2024-12-05T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
    rate_limit: 12.0  # seconds between requests (5 calls/minute for free tier)


  # CoinGlass - BTC Overview (Browser-based extraction)
  - id: coinglass_btc_overview
    name: "CoinGlass - BTC Overview"
    base_url: "https://www.coinglass.com"
    page_url: "https://www.coinglass.com/currencies/BTC"
    extraction_strategy: "dom_js_extraction"
    data_source:
      type: "browser"
      page_url: "https://www.coinglass.com/currencies/BTC"
    field_mappings:
      btc_price: "BTC Price"
      futures_volume_24h: "Futures Volume (24h)"
      spot_volume_24h: "Spot Volume (24h)"
      open_interest: "Open Interest"
      net_inflow_24h: "Net Inflow (24h)"
    robots_policy:
      status: "UNKNOWN"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
      notes: "Browser-based extraction to avoid paid API"
    rate_limit: 5.0  # seconds between requests (to avoid Cloudflare)

  # CoinGlass - Spot Inflow/Outflow (Browser-based extraction)
  - id: coinglass_spot_flows
    name: "CoinGlass - Spot Inflow/Outflow"
    base_url: "https://www.coinglass.com"
    page_url: "https://www.coinglass.com/currencies/BTC"
    extraction_strategy: "dom_js_extraction"
    data_source:
      type: "browser"
      page_url: "https://www.coinglass.com/currencies/BTC"
    field_mappings:
      net_inflow_5min: "Net Inflow (5 min)"
      net_inflow_1h: "Net Inflow (1 hour)"
      net_inflow_4h: "Net Inflow (4 hours)"
      net_inflow_12h: "Net Inflow (12 hours)"
      net_inflow_24h: "Net Inflow (24 hours)"
    robots_policy:
      status: "UNKNOWN"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
      notes: "Extracted from BTC overview page or dedicated page"
    rate_limit: 5.0

  # CoinGlass - Volatility Metrics (Browser-based extraction)
  - id: coinglass_volatility
    name: "CoinGlass - Volatility Metrics"
    base_url: "https://www.coinglass.com"
    page_url: "https://www.coinglass.com/volatility"
    extraction_strategy: "dom_js_extraction"
    data_source:
      type: "browser"
      page_url: "https://www.coinglass.com/volatility"
    field_mappings:
      btc_volatility_1d: "BTC Volatility (1-day)"
      eth_volatility_1d: "ETH Volatility (1-day)"
      sol_volatility_1d: "SOL Volatility (1-day)"
      xrp_volatility_1d: "XRP Volatility (1-day)"
      doge_volatility_1d: "DOGE Volatility (1-day)"
    robots_policy:
      status: "UNKNOWN"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
    rate_limit: 5.0

  # Dune Analytics - ETH Staking: Total ETH Deposited
  - id: dune_eth_staking_total_deposited
    name: "Dune - ETH Staking: Total ETH Deposited"
    base_url: "https://dune.com"
    page_url: "https://dune.com/queries/2361452"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://api.dune.com/api/v1/query"
      method: "POST"
      requires_auth: true
      query_id: "2361452"  # Amount of ETH staked query
      max_poll_attempts: 30
      poll_interval: 2
      parameters: {}
    field_mappings:
      total_eth_deposited: "Total ETH Deposited"
    robots_policy:
      status: "ALLOWED"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
      notes: "Query ID: 2361452. Fetches total ETH staked to consensus layer. Requires DUNE_API_KEY with Free tier (2500 credits)."
    rate_limit: 2.0
    auth_config:
      auth_type: "api_key"
      api_key_env: "DUNE_API_KEY"
      api_key_header: "x-dune-api-key"

  # Dune Analytics - ETH Staking: Validators and Depositors
  - id: dune_eth_staking_validators_depositors
    name: "Dune - ETH Staking: Validators & Depositors"
    base_url: "https://dune.com"
    page_url: "https://dune.com/queries/2361448"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://api.dune.com/api/v1/query"
      method: "POST"
      requires_auth: true
      query_id: "2361448"  # Validators and depositors query
      max_poll_attempts: 30
      poll_interval: 2
      parameters: {}
    field_mappings:
      total_validators: "Total Validators"
      distinct_depositor_addresses: "Distinct Depositor Addresses"
    robots_policy:
      status: "ALLOWED"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
      notes: "Query ID: 2361448. Fetches total validators and distinct depositor addresses. Requires DUNE_API_KEY with Free tier (2500 credits)."
    rate_limit: 2.0
    auth_config:
      auth_type: "api_key"
      api_key_env: "DUNE_API_KEY"
      api_key_header: "x-dune-api-key"

  # Dune Analytics - ETH Staking Statistics (Combined - uses both queries)
  - id: dune_eth_staking
    name: "Dune - ETH Staking Statistics (Combined)"
    base_url: "https://dune.com"
    page_url: "https://dune.com/underfire/eth-staking-statistics"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://api.dune.com/api/v1/query"
      method: "POST"
      requires_auth: true
      query_id: "2361448"  # Primary query (validators/depositors), will fetch from both queries
      max_poll_attempts: 30
      poll_interval: 2
      parameters: {}
    field_mappings:
      total_eth_deposited: "Total ETH Deposited"
      total_validators: "Total Validators"
      distinct_depositor_addresses: "Distinct Depositor Addresses"
    robots_policy:
      status: "ALLOWED"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
      notes: "Combined configuration. Fetches from query 2361448 (validators/depositors) and 2361452 (total ETH deposited). Requires DUNE_API_KEY with Free tier (2500 credits)."
    rate_limit: 2.0
    auth_config:
      auth_type: "api_key"
      api_key_env: "DUNE_API_KEY"
      api_key_header: "x-dune-api-key"
      api_key_format: "{key}"

  # The Block - Exchange Volume (Browser-based with API fallback)
  - id: theblock_exchange_volume
    name: "The Block - Exchange Volume"
    base_url: "https://www.theblock.co"
    page_url: "https://www.theblock.co/data/crypto-markets/spot/total-exchange-volume-daily"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://www.theblock.co/api/charts/chart/crypto-markets/spot/total-exchange-volume-daily"
      method: "GET"
      requires_auth: false
      headers: {}
    field_mappings:
      monthly_spot_volume: "Monthly Spot Volume"
      binance_spot_volume: "Binance Spot Volume"
      bybit_spot_volume: "Bybit Spot Volume"
      bitget_spot_volume: "Bitget Spot Volume"
      dex_monthly_volume: "DEX Monthly Volume"
    robots_policy:
      status: "UNKNOWN"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
      notes: "May require subscription for some data"
    rate_limit: 2.0

  # The Block - ETH vs BTC Volumes (Browser-based with API fallback)
  - id: theblock_eth_btc_volumes
    name: "The Block - ETH vs BTC Volumes"
    base_url: "https://www.theblock.co"
    page_url: "https://www.theblock.co/data/crypto-markets/spot/btc-and-eth-total-exchange-volume-7dma"
    extraction_strategy: "api_json"
    data_source:
      type: "api"
      endpoint: "https://www.theblock.co/api/charts/chart/crypto-markets/spot/btc-and-eth-total-exchange-volume-7dma"
      method: "GET"
      requires_auth: false
      headers: {}
    field_mappings:
      eth_monthly_spot_volume: "ETH Monthly Spot Volume"
      btc_monthly_spot_volume: "BTC Monthly Spot Volume"
      spot_eth_etf_net_flows: "Spot ETH ETF Net Flows"
      spot_btc_etf_net_flows: "Spot BTC ETF Net Flows"
      ytd_performance_eth_btc: "YTD Performance (ETH/BTC)"
    robots_policy:
      status: "UNKNOWN"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
    rate_limit: 2.0

  # Bitcoin.com - Derivatives Snapshot (Uses CoinGlass data)
  - id: bitcoin_com_derivatives_snapshot
    name: "CoinGlass - Derivatives Snapshot (BTC)"
    base_url: "https://www.coinglass.com"
    page_url: "https://www.coinglass.com/currencies/BTC"
    extraction_strategy: "dom_js_extraction"
    data_source:
      type: "browser"
      page_url: "https://www.coinglass.com/currencies/BTC"
    field_mappings:
      futures_oi_all_exchanges: "Futures OI (All Exchanges)"
      cme_btc_oi: "CME BTC OI"
      binance_btc_oi: "Binance BTC OI"
      btc_options_calls_oi: "BTC Options Calls OI"
      btc_options_puts_oi: "BTC Options Puts OI"
    robots_policy:
      status: "UNKNOWN"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
      notes: "Derivatives snapshot from CoinGlass BTC page. All OI values are validated to be positive."
    rate_limit: 5.0

  # CoinGlass - Liquidations (replaces Invezz)
  - id: invezz_liquidations
    name: "CoinGlass - Liquidations"
    base_url: "https://www.coinglass.com"
    page_url: "https://www.coinglass.com/LiquidationData"
    extraction_strategy: "dom_js_extraction"
    data_source:
      type: "browser"
      page_url: "https://www.coinglass.com/LiquidationData"
    field_mappings:
      total_liquidations_24h: "Total Liquidations (24h)"
      long_liquidations: "Long Liquidations"
      short_liquidations: "Short Liquidations"
      btc_liquidations_24h: "BTC Liquidations (24h)"
      eth_liquidations_24h: "ETH Liquidations (24h)"
    robots_policy:
      status: "UNKNOWN"
      last_checked: "2025-12-09T00:00:00Z"
      override_approved: false
    metadata:
      created: "2025-12-09T00:00:00Z"
      created_by: "manual"
      last_successful_extraction: null
      requires_subscription: false
      notes: "Switched from Invezz to CoinGlass for more accurate liquidations data. Browser-based extraction."
    rate_limit: 5.0

